<!doctype html>
<html>
    <title>tickls.com</title>
    <head>
        <!-- 
            Nice little script which takes care of the webgl boilerplate boring stuff and passes all the the shader toy variables to the shader.
            Mucho gracias to the guy who shared this @ https://github.com/halvves
        -->
        <script src="shaderpen.js"></script> 
    </head>
    <body>
        <script>
            // Simple function to load a text file (shader in this case) from some url.
            const parseShaderName = () => {
                var url = '' + window.location;
                var paramsArr = url.split('#');
                var shaderName = 'tickls_grid';

                if(paramsArr !== undefined && paramsArr.length > 1) {
                    shaderName = paramsArr[1];
                }

                return shaderName;
            };

            function loadShader(url) {
                return new Promise((resolve, reject) => {
                    console.log(`Loading shader: ${url}..`);
                    var req = new XMLHttpRequest();

                    req.onreadystatechange = () => {
                        if(req.readyState === 4) { // Done
                            if(req.status === 200) {
                                return resolve(req.responseText);
                            }

                            return reject(`Could not get shader at url: ${url}`);
                        }
                    }

                    req.open('GET', url); // Not async
                    req.send();
                });
            }

            const shaderName = parseShaderName();

            console.log(`shaderName: ${shaderName}`);

            loadShader(`shaders/${shaderName}.shader`)
                .then(shaderStr => {
                    new ShaderPen(shaderStr);
                })
                .catch(err => {
                    console.error(`Some error occurred somewhere :-( Err: ${err}`);
                });
        </script>
   </body>
</html>